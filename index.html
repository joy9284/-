<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ä¸‹åˆèŒ¶è½‰ç›¤</title>
<style>
  body { font-family: sans-serif; background:#f7f7f7; margin:0; padding:20px; }
  .container { max-width:900px; margin:auto; }
  .panel, .wheel-box { background:#fff; padding:20px; border-radius:16px; box-shadow:0 2px 10px #0001; }
  .row { display:flex; gap:12px; margin-top:10px; }
  input[type=text] { flex:1; padding:8px; border-radius:8px; border:1px solid #ccc; }
  button { padding:8px 12px; border:none; border-radius:8px; cursor:pointer; }
  .wheel { width:320px; height:320px; border-radius:50%; margin:auto; position:relative; transition:transform 4s cubic-bezier(0.25, 0.1, 0.25, 1); box-shadow:0 0 10px #0002; }
  .pointer { width:0; height:0; border-left:12px solid transparent; border-right:12px solid transparent; border-bottom:20px solid red; position:absolute; top:-22px; left:50%; transform:translateX(-50%); }
  .result { text-align:center; margin-top:10px; font-size:20px; font-weight:bold; }
  .list { max-height:150px; overflow-y:auto; margin-top:10px; }
  .item { display:flex; align-items:center; gap:8px; margin-bottom:6px; }
  .color-dot { width:10px; height:10px; border-radius:50%; }
  .delete-btn { background:#fee; color:#d33; padding:4px 8px; }
</style>
</head>
<body>
<div class="container">
  <h1>ä¸‹åˆèŒ¶è½‰ç›¤ ğŸ¡</h1>

  <div class="row" style="align-items:flex-start;">
    <!-- æ§åˆ¶é¢æ¿ -->
    <div class="panel" style="flex:1;">
      <h3>æ–°å¢é¸é …</h3>
      <div class="row">
        <input id="input" type="text" placeholder="è¼¸å…¥é¸é …..." />
        <button onclick="addOption()" style="background:#4da3ff; color:white;">æ–°å¢</button>
      </div>

      <h3 style="margin-top:20px;">é¸é …æ¸…å–®</h3>
      <div id="list" class="list"></div>

      <div class="row" style="margin-top:14px;">
        <button onclick="spin()" style="flex:1; background:#38c172; color:white;">é–‹å§‹è½‰</button>
        <button onclick="clearOptions()">æ¸…ç©º</button>
      </div>
    </div>

    <!-- è½‰ç›¤å€ -->
    <div class="wheel-box" style="flex:1; text-align:center;">
      <div class="pointer"></div>
      <div id="wheel" class="wheel"></div>
      <div id="result" class="result"></div>
    </div>
  </div>
</div>

<script>
const KEY = "tea-wheel-options-v1";
const COLORS = ["#F97316", "#F43F5E", "#7C3AED", "#0EA5E9", "#10B981", "#F59E0B", "#06B6D4", "#60A5FA"]; 
let options = [];
let spinDeg = 0;
let spinning = false;

// åˆå§‹è®€å–
load();
render();
updateWheel();

function save() { localStorage.setItem(KEY, JSON.stringify(options)); }
function load() {
  const raw = localStorage.getItem(KEY);
  if (raw) options = JSON.parse(raw);
  if (!Array.isArray(options) || options.length === 0)
    options = ["çç å¥¶èŒ¶", "æ°´æœèŒ¶", "è›‹ç³•", "å°é»å¿ƒ"]; 
}

function addOption() {
  const input = document.getElementById("input");
  const val = input.value.trim();
  if (!val) return;
  options.push(val);
  input.value = "";
  save(); render(); updateWheel();
}

function deleteOption(i) {
  options.splice(i,1);
  save(); render(); updateWheel();
}

function editOption(i, val) {
  options[i] = val;
  save(); updateWheel();
}

function clearOptions() {
  if (confirm("ç¢ºå®šè¦æ¸…ç©ºæ‰€æœ‰é¸é …ï¼Ÿ")) {
    options = [];
    save(); render(); updateWheel();
  }
}

// æ¸²æŸ“åˆ—è¡¨
function render() {
  const list = document.getElementById("list");
  list.innerHTML = options.map((opt,i)=>`
    <div class="item">
      <div class="color-dot" style="background:${COLORS[i % COLORS.length]}"></div>
      <input value="${opt}" oninput="editOption(${i}, this.value)" style="flex:1; padding:4px;" />
      <button class="delete-btn" onclick="deleteOption(${i})">åˆªé™¤</button>
    </div>
  `).join("");
}

// ç”Ÿæˆè½‰ç›¤
function updateWheel() {
  const wheel = document.getElementById("wheel");
  if (options.length === 0) {
    wheel.style.background = "#eee";
    return;
  }
  const size = 100 / options.length;
  const parts = options.map((_,i)=>`${COLORS[i % COLORS.length]} ${i*size}% ${(i+1)*size}%`).join(", ");
  wheel.style.background = `conic-gradient(${parts})`;
}

// æŠ½
function spin() {
  if (spinning || options.length === 0) return;
  spinning = true;
  document.getElementById("result").innerHTML = "";

  const rounds = Math.floor(Math.random()*4)+3;
  const offset = Math.random()*360;
  const addDeg = rounds*360 + offset;
  spinDeg += addDeg;

  const wheel = document.getElementById("wheel");
  wheel.style.transform = `rotate(${spinDeg}deg)`;

  const slice = 360 / options.length;

  const final = (360 - (addDeg % 360) + 90) % 360;
  const index = Math.floor(final / slice) % options.length;

  setTimeout(()=>{
    spinning = false;
    document.getElementById("result").innerHTML = `çµæœï¼š${options[index]}`;
  }, 4200);
}
</script>
</body>
</html>
